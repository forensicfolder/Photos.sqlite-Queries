SELECT

ACHANGE.Z_PK,
ACHANGE.ZENTITY,
PK_ZENTITY.Z_NAME AS 'Entity Name',
ACHANGE.ZENTITYPK,
'0x' || SUBSTR(HEX(ACHANGE.ZCOLUMNS), 1)  AS 'ZCOLUMNS_Hex', COUNT (*),
ZADDITIONALASSETATTRIBUTES.ZSHARECOUNT,
ZADDITIONALASSETATTRIBUTES.ZPENDINGSHARECOUNT,
ZASSET.ZFILENAME,
ZADDITIONALASSETATTRIBUTES.ZORIGINALFILENAME

FROM ACHANGE
LEFT JOIN ATRANSACTION
ON ATRANSACTION.Z_PK = ACHANGE.ZTRANSACTIONID 

LEFT JOIN ATRANSACTIONSTRING AS TS_ZAUTHORTS
ON TS_ZAUTHORTS.Z_PK = ATRANSACTION.ZAUTHORTS

LEFT JOIN ATRANSACTIONSTRING AS TS_ZCONTEXTNAMETS
ON TS_ZCONTEXTNAMETS.Z_PK = ATRANSACTION.ZCONTEXTNAMETS

LEFT JOIN Z_PRIMARYKEY AS PK_Z_ENT
ON PK_Z_ENT.Z_ENT = ACHANGE.Z_ENT 

LEFT JOIN Z_PRIMARYKEY AS PK_ZENTITY
ON PK_ZENTITY.Z_ENT = ACHANGE.ZENTITY 

LEFT JOIN ZASSET
ON ZASSET.Z_PK = ACHANGE.ZENTITYPK

LEFT JOIN ZADDITIONALASSETATTRIBUTES
ON ZADDITIONALASSETATTRIBUTES.Z_PK = ACHANGE.ZENTITYPK

WHERE
PK_ZENTITY.Z_NAME = 'AdditionalAssetAttributes'
AND 
ZCOLUMNS_HEX = '0x0000000000001000000000'
AND
ZADDITIONALASSETATTRIBUTES.ZSHARECOUNT IS NOT NULL 
OR
PK_ZENTITY.Z_NAME = 'AdditionalAssetAttributes'
AND 
ZCOLUMNS_HEX = '0x0000000000000400000000'
AND
ZADDITIONALASSETATTRIBUTES.ZSHARECOUNT IS NOT NULL
OR
PK_ZENTITY.Z_NAME = 'AdditionalAssetAttributes'
AND 
ZCOLUMNS_HEX = '0x000000000000020000000000'
AND
ZADDITIONALASSETATTRIBUTES.ZSHARECOUNT IS NOT NULL

GROUP BY ZENTITYPK
ORDER BY ZENTITYPK
