SELECT

ACHANGE.ZENTITY,
PK_ZENTITY.Z_NAME AS 'Entity Name',
ACHANGE.ZENTITYPK,

CASE
WHEN ACHANGE.ZENTITY IS 3 THEN ZASSET.ZFILENAME
ELSE NULL
END AS 'File Name',

ZASSET.ZTRASHEDSTATE,
'0x' || SUBSTR(HEX(ACHANGE.ZCOLUMNS), 1)  AS 'ZCOLUMNS_Hex',

TS_ZCONTEXTNAMETS.ZNAME AS 'Context Name',
ATRANSACTION.ZTIMESTAMP,
datetime (ATRANSACTION.ZTIMESTAMP + 978307200, 'unixepoch') AS 'Date and Time'

FROM ACHANGE

LEFT JOIN ATRANSACTION
ON ATRANSACTION.Z_PK = ACHANGE.ZTRANSACTIONID 

LEFT JOIN ATRANSACTIONSTRING AS TS_ZAUTHORTS
ON TS_ZAUTHORTS.Z_PK = ATRANSACTION.ZAUTHORTS

LEFT JOIN ATRANSACTIONSTRING AS TS_ZBUNDLEIDTS
ON TS_ZBUNDLEIDTS.Z_PK = ATRANSACTION.ZBUNDLEIDTS

LEFT JOIN ATRANSACTIONSTRING AS TS_ZCONTEXTNAMETS
ON TS_ZCONTEXTNAMETS.Z_PK = ATRANSACTION.ZCONTEXTNAMETS

LEFT JOIN ATRANSACTIONSTRING AS TS_ZPROCESSIDTS
ON TS_ZPROCESSIDTS.Z_PK = ATRANSACTION.ZPROCESSIDTS

LEFT JOIN Z_PRIMARYKEY AS PK_Z_ENT
ON PK_Z_ENT.Z_ENT = ACHANGE.Z_ENT 

LEFT JOIN Z_PRIMARYKEY AS PK_ZENTITY
ON PK_ZENTITY.Z_ENT = ACHANGE.ZENTITY 

LEFT JOIN ZASSET
ON ZASSET.Z_PK = ACHANGE.ZENTITYPK

WHERE 
PK_ZENTITY.Z_NAME = 'Asset'
AND
ZCOLUMNS_Hex LIKE '0x00000000000000000000040005%'
AND
TS_ZCONTEXTNAMETS.ZNAME LIKE 'PhotoKit%'
OR
PK_ZENTITY.Z_NAME = 'Asset'
AND
ZCOLUMNS_Hex LIKE '0x00000000000000000000040006%'
AND
TS_ZCONTEXTNAMETS.ZNAME LIKE 'PhotoKit%'
OR
PK_ZENTITY.Z_NAME = 'Asset'
AND
ZCOLUMNS_Hex LIKE '0x00000000000000000000040007%'
AND
TS_ZCONTEXTNAMETS.ZNAME LIKE 'PhotoKit%'
OR
PK_ZENTITY.Z_NAME = 'Asset'
AND
ZCOLUMNS_Hex LIKE '0x00000000000000000000020001%'
AND
TS_ZCONTEXTNAMETS.ZNAME LIKE 'PhotoKit%'
OR
PK_ZENTITY.Z_NAME = 'Asset'
AND
ZCOLUMNS_Hex LIKE '0x00000000000000000000000010000E00000000'
AND
TS_ZCONTEXTNAMETS.ZNAME LIKE 'PhotoKit%'

ORDER BY 
ZENTITYPK ASC,
ZTIMESTAMP ASC
