SELECT

ACHANGE.ZCHANGETYPE,
ACHANGE.ZENTITY,
PK_ZENTITY.Z_NAME AS "Entity Name",
ACHANGE.ZENTITYPK,
ZASSET.ZIMPORTSESSION,
ZASSET.ZFILENAME,
ZADDITIONALASSETATTRIBUTES.ZORIGINALFILENAME,
ACHANGE.ZTRANSACTIONID,
ATRANSACTION.ZCONTEXTNAMETS,
TS_ZCONTEXTNAMETS.ZNAME AS "Context Name",
ATRANSACTION.ZTIMESTAMP,
datetime (ATRANSACTION.ZTIMESTAMP + 978307200, 'unixepoch') AS 'Timestamp'

FROM ACHANGE

LEFT JOIN ATRANSACTION
ON ATRANSACTION.Z_PK = ACHANGE.ZTRANSACTIONID 

LEFT JOIN ATRANSACTIONSTRING AS TS_ZAUTHORTS
ON TS_ZAUTHORTS.Z_PK = ATRANSACTION.ZAUTHORTS

LEFT JOIN ATRANSACTIONSTRING AS TS_ZCONTEXTNAMETS
ON TS_ZCONTEXTNAMETS.Z_PK = ATRANSACTION.ZCONTEXTNAMETS

LEFT JOIN Z_PRIMARYKEY AS PK_Z_ENT
ON PK_Z_ENT.Z_ENT = ACHANGE.Z_ENT 

LEFT JOIN Z_PRIMARYKEY AS PK_ZENTITY
ON PK_ZENTITY.Z_ENT = ACHANGE.ZENTITY 

LEFT JOIN ZADDITIONALASSETATTRIBUTES
ON ZADDITIONALASSETATTRIBUTES.Z_PK = ACHANGE.ZENTITYPK

LEFT JOIN ZASSET
ON ZASSET.Z_PK = ACHANGE.ZENTITYPK

WHERE 
TS_ZCONTEXTNAMETS.ZNAME LIKE '%sharingd%'
AND
ACHANGE.ZCHANGETYPE IS '0'
AND
PK_ZENTITY.Z_NAME IS 'Asset'

ORDER BY ZTRANSACTIONID
